{
  "ProjectName": "betterbindingsource",
  "Title": "Better BindingSource control for Winforms",
  "Description": "A better windows forms (winforms) bindingsource control which enables you to add class based datasources without the hassle of adding datasource files and using the slow wizard to add data sources.",
  "MovedLink": "",
  "HomeWiki": "<div class=\"wikidoc\"><b>Project Description</b><br />A better windows forms &#40;winforms&#41; bindingsource control which enables you to add class based datasources without the hassle of adding datasource files and using the slow wizard to add data sources.<br /><br />Code:<br /><br />using System;<br />using System.Collections.Generic;<br />using System.ComponentModel;<br />using System.Diagnostics;<br />using System.Drawing;<br />using System.Linq;<br />using System.Reflection;<br />using System.Text;<br />using System.Windows.Forms;<br /><br /><br /><br />namespace Steen.L.Knudsen<br />{   <br />    (ToolboxBitmap(typeof(resfinder), &quot;BetterBindingSource.bmp&quot;))<br />    class BetterBindingSource : BindingSource<br />    {<br /><br />        [<br />        Browsable(false),<br />        Category(&quot;&quot;),<br />        Description(&quot;DataSourceType&quot;)<br />        ]<br />        public Type DataSourceType { get; set; }<br /><br /><br />        public String _dataSourceText = &quot;&quot;;<br />        (<br />            Browsable(true),<br />            RefreshPropertiesAttribute(RefreshProperties.All),<br />            Category(&quot;&quot;),<br />            Description(&quot;DataSourceText&quot;)<br />        )<br />        public String DataSourceText<br />        {<br />            get<br />            {<br />                return _dataSourceText;<br />            }<br />            set<br />            {<br />                _dataSourceText = value;<br />                <br />                if (this.DesignMode &amp;&amp; _dataSourceText != &quot;&quot;)<br />                {<br />                    try<br />                    {<br />                        DataSourceType = System.Type.GetType(_dataSourceText);<br />                        if (DataSourceType == null)<br />                        {<br />                            Error = &quot;Error type not found!&quot;;<br />                            Type t = Find(_dataSourceText);<br />                            DataSourceType = t;<br />                            if (t != null)<br />                            {<br />                                _dataSourceText = t.FullName;<br />                                _dataSourceText = &quot;&quot;;<br />                            }<br />                            else<br />                            {<br />                                _dataSourceText = &quot;&quot;;<br />                            }<br />                        }<br />                        this.DataSource = DataSourceType;<br />                        <br />                        Error = &quot;&quot;;<br /><br />                    }<br />                    catch (Exception ex)<br />                    {<br />                        <br />                        Error = &quot;Error! &quot; + ex.Message;<br />                        Type t = Find(_dataSourceText);<br />                        DataSourceType = t;<br />                        if (t != null)<br />                        {<br />                            _dataSourceText = t.FullName;<br />                        }<br />                        else<br />                        {<br />                            _dataSourceText = &quot;&quot;;<br />                        }<br />                    }<br />                }<br /><br />            }<br />        }<br /><br />        <a href=\"https://betterbindingsource.codeplex.com/wikipage?title=Browsable%28false%29%2c%0a%20%20%20%20%20%20%20%20Category%28%22%22%29%2c%0a%20%20%20%20%20%20%20%20Description%28%22Error%22%29&referringTitle=Home\">Browsable&#40;false&#41;,<br />        Category&#40;&#34;&#34;&#41;,<br />        Description&#40;&#34;Error&#34;&#41;</a><br />        public String Error { get; set; }<br /><br />        public BetterBindingSource()<br />            : base()<br />        {<br /><br />        }<br />        public BetterBindingSource(IContainer container)<br />            : base(container)<br />        {<br /><br />        }<br /><br />        public BetterBindingSource(Object obj, String str)<br />            : base(obj, str)<br />        {<br /><br />        }<br /><br /><br />        public Type Find(string className)<br />        {<br />            var loadedAssemblies = AppDomain.CurrentDomain.GetAssemblies();<br />            foreach(Assembly thisAsm in loadedAssemblies)<br />            {<br />                <br />                List&lt;Type&gt; types = thisAsm.GetTypes()<br />                    .Where(t =&gt; !t.IsAbstract &amp;&amp; t.Name == className).ToList();<br /><br />                if (types.Count == 1)<br />                {<br />                    return types.First();<br />                }<br /><br />                types = thisAsm.GetTypes()<br />                    .Where(t =&gt; !t.IsAbstract &amp;&amp; t.Name.Contains(className)).ToList();<br /><br />                if (types.Count == 1)<br />                {<br />                    return types.First();<br />                }<br /><br />                Debug.WriteLine(&quot;&quot;);<br />            }<br />            <br />            return null;<br />        }<br /><br /><br />    }<br /><br />    internal class resfinder<br />    {<br /><br />    }<br />}<br /><br />Created by: <br />Steen Ladegaard Knudsen</div><div class=\"ClearBoth\"></div>",
  "TagList": "",
  "LastEdited": "2011-03-09T07:01:20.53-08:00"
}