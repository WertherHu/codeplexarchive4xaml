{
  "ProjectName": "ExportSQLScript",
  "Title": "ExportSQLScript - Export MS SQL 2008R2/2008/2005/2000 objects to script",
  "Description": "Command line driven utility to export MS SQL objects to script files suitable for database creation and revision control.\nUses 2008R2 Server Management Objects (SMO) which are compatible with SQL Server 2000, SQL Server 2005, SQL Server 2008 and SQL Server 2008 R2.",
  "MovedLink": "",
  "HomeWiki": "<div class=\"wikidoc\"><h2>Project Description</h2>\rCommand line driven utility to export MS SQL objects to script files suitable for database creation and revision control.<br />Uses 2008R2 Server Management Objects &#40;SMO&#41; which are compatible with SQL Server 2000, SQL Server 2005, SQL Server 2008 and SQL Server 2008 R2.<br />\n<h3>Submitting Patches</h3>\rA few people have submitted patches, and I appreciate them. If possible, please provide the patch as a <a href=\"http://www.gnu.org/software/diffutils/manual/html_node/Example-Unified.html\">unified diff</a>. It&#39;s much easier for me to apply.<br />\n<h2>Quick Start</h2>\r<h3>Running the tool</h3>\rIn a nutshell<br /><pre>\nEXPORTSQLSCRIPT Server Database\n</pre><br />That&#39;ll script to StdOut by default. <br /><br />Chances are, you&#39;ll want the file based tree: &quot;/ot:Tree&quot;, dependency order info: &quot;/of:<i>file</i>&quot;, a particular output directory: &quot;/od:<i>outdir</i>&quot; &amp; schema info &quot;/ssq&quot;<br /><pre>\nExportSQLScript.exe localhost AdventureWorks /ot:Tree /of:CreationOrder.txt /od:&quot;outdir&quot; /ssq\n</pre><br />\n<h3>Recreating the DB</h3>\rThis tool only provides output scripts. But something simple like CMD.EXE can achieve this:<br /><pre>\nC:\\&gt;sqlcmd -E -S localhost -Q &quot;CREATE DATABASE MYDB&quot;\n\nC:\\&gt;for /F &quot;&quot; %i in (CreationOrder.txt) do sqlcmd -E -S localhost -d MYDB -f 65001 -i %i\n</pre><br /><br />You&#39;ll need to change &quot;%i&quot; to &quot;%%i&quot; for use inside a batch file.<br />&quot;-f 65001&quot; tells SQLCMD to use UTF-8, otherwise extended characters may incorrectly translated.<br /><br />You may need the Microsoft&#174; SQL Server&#174; 2008 R2 Shared Management Objects:<br /><a href=\"http://www.microsoft.com/downloads/en/details.aspx?displaylang=en&amp;FamilyID=ceb4346f-657f-4d28-83f5-aae0c5c83d52\">http://www.microsoft.com/downloads/en/details.aspx?displaylang=en&amp;FamilyID=ceb4346f-657f-4d28-83f5-aae0c5c83d52</a><br />\n<h2>Why?</h2>\rI had two needs:\n<ol><li>Turn a database into a set of scripts able to create the database</li>\n<li>Turn a database into a set of scripts suitable to version control</li></ol>\n<br /><b>The dependency problem</b><br />If you create all objects within a single file:\n<ul><li>You can include them in dependency order.</li>\n<li>If you modify a dependency the whole file changes drastically, confusing diff tools</li></ul>\nIf you create all objects in separate files:\n<ul><li>You can include them in dependency file in order.</li>\n<li>If you modify a dependency a small section of the dependency file changes, NOT confusing diff tools</li></ul>\n<br /><b>SQL Server Management Studio</b><br />SQL Server Management Studio&#39;s &quot;Generate SQL Server Scripts Wizard&quot; appeared to be the right tool for the job but:\n<ul><li>After fulfilling dependencies, objects were created in no particular order (could change between DB instances)</li>\n<li>Some export options didn&#39;t function at all</li>\n<li>Doesn&#39;t lend itself to automation</li></ul>\n\n<h2>An Answer</h2>\rA command line tool for exporting schema objects from SQL databases.<br />Creates one file in creation order, or mutiple files including a creation order file.<br />A work in progress, but useful enough to share.<br />\n<h2>Progress</h2>\rCurrent <a href=\"https://exportsqlscript.codeplex.com/wikipage?title=Test%20Results&referringTitle=Home\">Test Results</a></div><div class=\"ClearBoth\"></div>",
  "TagList": "C#,SQL,SQL Server,SQL Server 2005,SQL Server 2000,SSDE,Sql scripter,SQL Server 2008,SQL Server 2008 R2,SQL Tools,",
  "LastEdited": "2011-03-15T19:41:11.843-07:00"
}