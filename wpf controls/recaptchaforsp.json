{
  "ProjectName": "recaptchaforsp",
  "Title": "reCAPTCHA for SharePoint",
  "Description": "The solution contains a .NET user control, web part, and custom SPField for SharePoint 2010.  Allows reCAPTCHA to be quickly and easily integrated into OOB and custom pages along with any content type or list-related form.",
  "MovedLink": "",
  "HomeWiki": "<div class=\"wikidoc\">\r\n<p><strong>Project Description</strong><br>\r\nThe solution contains a .NET user control, web part, and custom SPField for SharePoint 2010. Allows reCaptcha to be quickly and easily integrated into OOB and custom pages along with any content type or list-related form.<br>\r\n<br>\r\n</p>\r\n<h1 style=\"margin:24pt 0in 0pt\"><a name=\"_Toc299801459\"><span style=\"font-family:Cambria; color:#365f91; font-size:large\"><strong>Overview</strong></span></a></h1>\r\n<h2 style=\"margin:10pt 0in 0pt\"><a name=\"_Toc299801460\"><strong><span style=\"font-family:Cambria; color:#4f81bd; font-size:medium\">What is a CAPTCHA?</span></strong></a></h2>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">From Wikipedia: &ldquo;A <strong><em>CAPTCHA</em></strong> is a type of challenge-response test used in computing as an attempt to ensure that the response is generated by a person. The process usually involves\r\n one computer (a server) asking a user to complete a simple test which the computer is able to generate and grade. Because other computers are supposedly unable to solve the CAPTCHA, any user entering a correct solution is presumed to be human. Thus, it is\r\n sometimes described as a reverse Turing test, because it is administered by a machine and targeted to a human, in contrast to the standard Turing test that is typically administered by a human and targeted to a machine. A common type of CAPTCHA requires the\r\n user to type letters or digits from a distorted image that appears on the screen&rdquo;.\r\n</span></p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\"><strong><em><span lang=\"EN\">CAPTCHA</span></em></strong><span lang=\"EN\"> It is an acronym based on the word &quot;capture&quot; and standing for &quot;<strong>C</strong>ompletely\r\n<strong>A</strong>utomated <strong>P</strong>ublic <strong>T</strong>uring test to tell\r\n<strong>C</strong>omputers and <strong>H</strong>umans <strong>A</strong>part&quot;. </span>\r\n</p>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">&nbsp;</span>&nbsp;&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">For more information go to: </span>\r\n<a href=\"http://en.wikipedia.org/wiki/CAPTCHA\"><span lang=\"EN\"><span style=\"color:#0000ff\">http://en.wikipedia.org/wiki/CAPTCHA</span></span></a><span lang=\"EN\">\r\n</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">&nbsp;</span></p>\r\n<h2 style=\"margin:10pt 0in 0pt\"><a name=\"_Toc299801461\"><span lang=\"EN\"><strong><span style=\"font-family:Cambria; color:#4f81bd; font-size:medium\">What is reCAPTCHA?</span></strong></span></a><span lang=\"EN\">\r\n</span></h2>\r\n<p style=\"margin:0in 0in 0pt\"><span style=\"font-family:&quot;Helvetica&quot;,&quot;sans-serif&quot;; color:black; font-size:9pt\">reCAPTCHA is a free CAPTCHA service that helps to digitize books, newspapers and old time radio shows</span><span lang=\"EN\">\r\n</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">&nbsp;</span>&nbsp;&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\"><span lang=\"EN\">For more information go to: </span>\r\n<a href=\"http://www.google.com/recaptcha/learnmore\"><span lang=\"EN\"><span style=\"color:#0000ff\">http://www.google.com/recaptcha/learnmore</span></span></a><span lang=\"EN\">\r\n</span></p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<h2 style=\"margin:10pt 0in 0pt\"><span lang=\"EN\"><span><span style=\"font-family:Cambria; color:#4f81bd; font-size:medium\"><strong>&nbsp;</strong></span></span></span><a name=\"_Toc299801462\"><strong><span style=\"font-family:Cambria; color:#4f81bd; font-size:medium\">reCAPTCHA\r\n for SharePoint</span></strong></a></h2>\r\n<p style=\"margin:0in 0in 10pt\">The reCAPTCHA for SharePoint solution takes what the reCAPTCHA service natively provides web site administrators and developers and makes it quickly and easily consumable within SharePoint.<span>&nbsp;\r\n</span>The solution provides the following capabilities:</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.75in\"><span style=\"line-height:115%; font-family:symbol; color:#365f91; font-size:14pt\"><span>&middot;<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>A .NET User Control that can be added to custom application pages or dialogs via Visual Studio.<strong><span style=\"line-height:115%; font-family:&quot;Cambria&quot;,&quot;serif&quot;; color:#365f91; font-size:14pt\">\r\n</span></strong></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.75in\"><span style=\"line-height:115%; font-family:symbol; color:#365f91; font-size:14pt\"><span>&middot;<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>A Web Part that can be added to existing pages via the browser, SharePoint Designer, or Visual Studio.<strong><span style=\"line-height:115%; font-family:&quot;Cambria&quot;,&quot;serif&quot;; color:#365f91; font-size:14pt\">\r\n</span></strong></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 10pt 0.75in\"><span style=\"line-height:115%; font-family:symbol; color:#365f91; font-size:14pt\"><span>&middot;<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>A custom SharePoint Field (SPField) that can be added to existing or new content types and lists.<strong><span style=\"line-height:115%; font-family:&quot;Cambria&quot;,&quot;serif&quot;; color:#365f91; font-size:14pt\">\r\n</span></strong></p>\r\n<p style=\"margin:0in 0in 10pt\">The following sections will cover installing, configuring, and using this solution in your SharePoint environment.\r\n<br style=\"page-break-before:always\">\r\n</p>\r\n<h1 style=\"margin:24pt 0in 0pt\"><a name=\"_Toc299801463\"><strong><span style=\"font-family:Cambria; color:#365f91; font-size:large\">Installing and Activating the Solution</span></strong></a></h1>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">At some point in the near future I will come up with a nice little installer applet for deploying my SharePoint solutions, but for now you&rsquo;ll have to do it the &ldquo;hard way&rdquo;.</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>1.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Save <strong>reCAPTCHA for SharePoint.wsp</strong> to a location on your SharePoint server.</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>2.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Go to <strong>Start</strong> &gt; <strong>All Programs</strong> &gt;\r\n<strong>Microsoft SharePoint 2010 Products</strong> and click the <strong>SharePoint 2010 Management Shell</strong> link.</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>3.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Type in the following command to add the Solution to SharePoint (&hellip;changing the path to represent where you saved the .WSP file in step 1):</p>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;</p>\r\n<div style=\"padding-bottom:1pt; padding-left:4pt; padding-right:4pt; margin-left:0.25in; margin-right:0in; padding-top:1pt; border:windowtext 1pt solid\">\r\n<p style=\"margin:0in 0in 0pt; padding:0in\">Add-SPSolution -LiteralPath &quot;c:\\reCAPTCHA for SharePoint.wsp&quot;</p>\r\n</div>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>4.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Type in the following command to deploy the solution to a specific web application (replace url with the URL of your web application:</p>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;</p>\r\n<div style=\"padding-bottom:1pt; padding-left:4pt; padding-right:4pt; margin-left:0.25in; margin-right:0in; padding-top:1pt; border:windowtext 1pt solid\">\r\n<p style=\"margin:0in 0in 0pt; padding:0in\">Install-SPSolution -Identity &quot;reCAPTCHA for SharePoint.wsp&quot; -GACDeployment -WebApplication http://url</p>\r\n</div>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">or the following if you want to deploy to all web applications</p>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;</p>\r\n<div style=\"padding-bottom:1pt; padding-left:4pt; padding-right:4pt; margin-left:0.25in; margin-right:0in; padding-top:1pt; border:windowtext 1pt solid\">\r\n<p style=\"margin:0in 0in 0pt; padding:0in\">Install-SPSolution -Identity &quot;reCAPTCHA for SharePoint.wsp&quot; -GACDeployment -AllWebApplications</p>\r\n</div>\r\n<p style=\"margin:0in 0in 0pt 0.25in\">&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>5.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Activate the feature on the desired site collection(s) (replace url with the URL of your site collection)</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<div style=\"padding-bottom:1pt; padding-left:4pt; padding-right:4pt; margin-left:0.25in; margin-right:0in; padding-top:1pt; border:windowtext 1pt solid\">\r\nEnable-SPFeature &ndash;identity &quot;reCAPTCHAforSharePoint&quot; -URL <a href=\"http://url\">\r\nhttp://url</a></div>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">NOTE:<span>&nbsp; </span>You can also activate the feature from\r\n<strong>Site Actions</strong> &gt; <strong>Site Settings</strong> &gt; <strong>Site collection features</strong> (under the\r\n<strong>Site Collection Administration</strong> section)</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.25in\"><span><span>6.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Done.&nbsp;</p>\r\n<h1 style=\"margin:24pt 0in 0pt\"><a name=\"_Toc299801464\"><strong><span style=\"font-family:Cambria; color:#365f91; font-size:large\">reCAPTCHA for SharePoint Properties</span></strong></a></h1>\r\n<p style=\"margin:0in 0in 10pt\">&nbsp;</p>\r\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\" style=\"border-collapse:collapse\">\r\n<tbody>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:white 3pt solid; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><strong><span style=\"color:white\">Property\r\n</span></strong></p>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 3pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><strong><span style=\"color:white\">Applies To\r\n</span></strong></p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 3pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><strong><span style=\"color:white\">Details\r\n</span></strong></p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:#f0f0f0; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:#f0f0f0; border-right:white 3pt solid; padding-top:0in\">\r\n<h2 style=\"line-height:normal; margin:10pt 0in 0pt\"><a name=\"_Toc299801465\"></a><a name=\"PrivateKey\"><span><span style=\"color:white; font-weight:normal\"><span style=\"font-family:Cambria; font-size:medium\">PrivateKey</span></span></span></a><span style=\"color:white; font-weight:normal\">\r\n</span></h2>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Web Part</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">User Control</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">SPField</p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">This is the private key provided you when you sign-up for reCAPTCHA and register a domain.</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Go to <a href=\"http://www.google.com/recaptcha\">\r\n<span style=\"color:#0000ff\">http://www.google.com/recaptcha</span></a> for details.</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:#f0f0f0; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 3pt solid; padding-top:0in\">\r\n<h2 style=\"line-height:normal; margin:10pt 0in 0pt\"><a name=\"_Toc299801466\"></a><a name=\"PublicKey\"><span><span style=\"color:white; font-weight:normal\"><span style=\"font-family:Cambria; font-size:medium\">PublicKey</span></span></span></a><span style=\"color:white; font-weight:normal\">\r\n</span></h2>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#d3dfee; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Web Part</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">User Control</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">SPField</p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#d3dfee; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">This is the public key provided you when you sign-up for reCAPTCHA and register a domain.</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Go to <a href=\"http://www.google.com/recaptcha\">\r\n<span style=\"color:#0000ff\">http://www.google.com/recaptcha</span></a> for details.</p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:#f0f0f0; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 3pt solid; padding-top:0in\">\r\n<h2 style=\"line-height:normal; margin:10pt 0in 0pt\"><a name=\"_Toc299801467\"></a><a name=\"Theme\"><span><span style=\"color:white; font-weight:normal\"><span style=\"font-family:Cambria; font-size:medium\">Theme</span></span></span></a><span style=\"font-weight:normal\">\r\n</span></h2>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Web Part</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">User Control</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">SPField</p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">This is the chrome the reCAPTCHA control will be rendered with.<span>&nbsp;\r\n</span>The possible values are:</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>red (default) </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>white </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>blackglass </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>clean</em></p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:#f0f0f0; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 3pt solid; padding-top:0in\">\r\n<h2 style=\"line-height:normal; margin:10pt 0in 0pt\"><a name=\"_Toc299801468\"></a><a name=\"Language\"><span><span style=\"color:white; font-weight:normal\"><span style=\"font-family:Cambria; font-size:medium\">Language</span></span></span></a><span style=\"font-weight:normal\">\r\n</span></h2>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#d3dfee; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Web Part</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">User Control</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">SPField</p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#d3dfee; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">This is the language the reCAPTCHA control will be rendered in.<span>&nbsp;\r\n</span>The possible values are:</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>English (default) </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>Dutch </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>French </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>German </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>Portuguese </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>Russian </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>Spanish </em></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><em>Turkish</em></p>\r\n</td>\r\n</tr>\r\n<tr>\r\n<td width=\"134\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:white 1pt solid; padding-bottom:0in; padding-left:5.4pt; width:100.3pt; padding-right:5.4pt; background:#4f81bd; border-top:white 1pt solid; border-right:white 3pt solid; padding-top:0in\">\r\n<h2 style=\"line-height:normal; margin:10pt 0in 0pt\"><a name=\"_Toc299801469\"></a><a name=\"TriggerControlId\"><span><span style=\"color:white; font-weight:normal\"><span style=\"font-family:Cambria; font-size:medium\">TriggerControlId</span></span></span></a><span style=\"font-weight:normal\">\r\n</span></h2>\r\n</td>\r\n<td width=\"187\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:140.55pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">Web Part</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">User Control</p>\r\n</td>\r\n<td width=\"317\" valign=\"top\" style=\"border-bottom:white 1pt solid; border-left:#f0f0f0; padding-bottom:0in; padding-left:5.4pt; width:237.95pt; padding-right:5.4pt; background:#a7bfde; border-top:#f0f0f0; border-right:white 1pt solid; padding-top:0in\">\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">This is the ID of the control that will cause the reCAPTCHA control to validate itself on postback.<span>&nbsp;\r\n</span>If omitted, any postback of the page containing the reCaptcha control will cause the control to validate itself.</p>\r\n</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<h1 style=\"margin:24pt 0in 0pt\"><strong><span style=\"font-size:large\"><span style=\"color:#365f91\"><span style=\"font-family:Cambria\"><span>Using the reCAPTCHA User Control in an SharePoint Application Page</span>\r\n</span></span></span></strong></h1>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><span style=\"font-family:consolas; background:yellow; font-size:9.5pt\">&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 10pt\">In this section I&rsquo;ve created a simple contact/inquiry dialog that you might see in a public website.<span>&nbsp;\r\n</span>The dialog is presented using the SharePoint 2010 dialog framework and on submission writes to a Contacts list in SharePoint.<span>&nbsp;\r\n</span>To ensure that we&rsquo;re dealing with a submission by a human and not some form of bot, we&rsquo;re going to add a reCAPTCHA user control to the form.</p>\r\n<p><a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266732\"><img title=\"pic1\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266732\" border=\"0\" alt=\"pic1\" width=\"241\" height=\"331\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"margin:0in 0in 10pt\">So the first thing I need to do is register the user control on the page.<span>&nbsp;\r\n</span>It is deployed to the <strong>14\\TEMPLATE\\CONTROLTEMPLATES\\SharePointable</strong> folder, so our Register tag will look something like this:</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; background:yellow; font-size:9.5pt\">&lt;%</span><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">@</span><span style=\"font-family:consolas; font-size:9.5pt\">\r\n<span style=\"color:maroon\">Register</span> <span style=\"color:red\">src</span><span style=\"color:blue\">=&quot;~/_controltemplates/SharePointable/reCAPTCHAUserControl.ascx&quot;</span>\r\n<span style=\"color:red\">TagPrefix</span><span style=\"color:blue\">=&quot;spable&quot;</span>\r\n<span style=\"color:red\">TagName</span><span style=\"color:blue\">=&quot;reCAPTCHA&quot;</span>\r\n<span style=\"background:yellow\">%&gt; </span></span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">With the control registered, we can add it to the desired location in our HTML.<span>&nbsp;\r\n</span>The <a href=\"http://recaptchaforsp.codeplex.com/#PrivateKey\"><span style=\"color:#0000ff\">PrivateKey</span></a> and\r\n<a href=\"http://recaptchaforsp.codeplex.com/#PublicKey\"><span style=\"color:#0000ff\">PublicKey</span></a> properties are required.<span>&nbsp;\r\n</span>You can optionally set the <a href=\"http://recaptchaforsp.codeplex.com/#TriggerControlId\">\r\n<span style=\"color:#0000ff\">TriggerControlId</span></a> property if you want validation of the reCaptcha entry to occur for a specific control&rsquo;s postback event or you can omit it if you want any postback to cause validation.<span>&nbsp;\r\n</span>In this case we&rsquo;re going to set it to the id of the form&rsquo;s Submit button.<span>&nbsp;\r\n</span>I&rsquo;m also going to set the <a href=\"http://recaptchaforsp.codeplex.com/#Theme\">\r\n<span style=\"color:#0000ff\">Theme</span></a> to white in lieu of the default red theme:<span style=\"font-family:consolas; background:yellow; font-size:9.5pt\">\r\n</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">&lt;</span><span style=\"font-family:consolas; color:maroon; font-size:9.5pt\">sharepointable</span><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">:</span><span style=\"font-family:consolas; color:maroon; font-size:9.5pt\">reCAPTCHA\r\n</span><span style=\"font-family:consolas; color:red; font-size:9.5pt\">runat</span><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">=&quot;server&quot;</span><span style=\"font-family:consolas; font-size:9.5pt\">\r\n<span style=\"color:red\">ID</span><span style=\"color:blue\">=&quot;reCaptchaContact&quot;</span>\r\n<span style=\"color:red\">privatekey</span><span style=\"color:blue\">=&quot;6LezNsYSAAAAAPnZ4o0Iv-QaFDo_6shEVf2oCguN&quot;</span>\r\n<span style=\"color:red\">publickey</span><span style=\"color:blue\">=&quot;6LezNsYSAAAAAGlpS29ZuK3yqceGMCHwUX27cWWv&quot;</span>\r\n<span style=\"color:red\">theme</span><span style=\"color:blue\">=&quot;white&quot;</span> <span style=\"color:red\">\r\ntriggercontrolid</span><span style=\"color:blue\">=&quot;Submit&quot;&gt;&lt;/</span><span style=\"color:maroon\">pa</span><span style=\"color:blue\">:</span><span style=\"color:maroon\">reCaptcha</span><span style=\"color:blue\">&gt;\r\n</span></span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\">The user control implements a <strong>\r\nCustomValidator</strong> so you can check <strong>Page.IsValid</strong> on postback to ensure that the reCaptcha entry was valid.<span style=\"font-family:consolas; color:blue; font-size:9.5pt\">\r\n</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt\"><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">&nbsp;</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; color:blue; font-size:9.5pt\">void</span><span style=\"font-family:consolas; font-size:9.5pt\"> Submit_Click(<span style=\"color:blue\">object</span> sender,\r\n<span style=\"color:#2b91af\">EventArgs</span> e) </span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; font-size:9.5pt\">{\r\n</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; color:blue; font-size:9.5pt\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>if</span><span style=\"font-family:consolas; font-size:9.5pt\"> (Page.IsValid)\r\n</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; font-size:9.5pt\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>{ </span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; font-size:9.5pt\"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span><span style=\"color:green\">// perform save </span></span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; font-size:9.5pt\"><span>&nbsp;&nbsp;&nbsp;\r\n</span>} </span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\"><span style=\"font-family:consolas; font-size:9.5pt\">}\r\n</span></p>\r\n<p style=\"line-height:normal; margin:0in 0in 0pt; background:#ffffcc\">&nbsp;</p>\r\n<h1 style=\"margin:24pt 0in 0pt\"><strong><span style=\"font-size:large\"><span style=\"color:#365f91\"><span style=\"font-family:Cambria\"><span>Using the reCAPTCHA Web Part in an SharePoint Web<span>&nbsp;\r\n</span>Part Page</span> </span></span></span></strong></h1>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">The web part is nothing more than a wrapper around the User Control in the previous section.<span>&nbsp;\r\n</span>That wrapper allows it to be added to a page and configured like any other web part.</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266462\"><img title=\"pic2\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266733\" border=\"0\" alt=\"pic2\" width=\"720\" height=\"244\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">When the web part is first added to a page the Private and Public keys are not set so you will see the following message:</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266464\"><img title=\"pic3\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266531\" border=\"0\" alt=\"pic3\" width=\"501\" height=\"41\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">Go to the web part&rsquo;s menu and select Edit Web Part:</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266466\"><img title=\"pic4\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266734\" border=\"0\" alt=\"pic4\" width=\"676\" height=\"74\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a>&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\"><span>&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 0pt\">Expand the Settings section and configure the web part as you like:</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266468\"><img title=\"pic5\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266530\" border=\"0\" alt=\"pic5\" width=\"262\" height=\"323\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p>&nbsp;<strong><span style=\"font-size:large\"><span style=\"color:#365f91\"><span style=\"font-family:Cambria\"><span>Using the reCAPTCHA SPField</span></span></span></span></strong></p>\r\n<p style=\"margin:0in 0in 0pt\">While the User Control and Web Part are certainly useful, neither is so seamlessly integrated with OOB SharePoint functionality like the SPField.<span>&nbsp;\r\n</span>Once deployed and activated, you can add a property to an existing list or content type using this field type and instantly have reCAPTCHA functionality on the Add and Edit forms for that item/content type.<span>&nbsp;\r\n</span>I found it particularly useful for blog comments, so I&rsquo;ll walk you through how I set that up.</p>\r\n<p style=\"margin:0in 0in 0pt\">&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>1.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Navigate to your Blog site.</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>2.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Open <strong>Site Actions</strong> and select <strong>View All Site Content</strong></p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266470\"><img title=\"pic6\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266739\" border=\"0\" alt=\"pic6\" width=\"177\" height=\"244\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>3.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Under the <strong>Lists</strong> section select <strong>Comments</strong>&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266472\"><img title=\"pic7\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266529\" border=\"0\" alt=\"pic7\" width=\"555\" height=\"137\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:black 1px solid\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>4.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Select the <strong>List</strong> view and then click <strong>\r\nList Settings</strong> on the ribbon bar&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266474\"><img title=\"pic8\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266740\" border=\"0\" alt=\"pic8\" width=\"554\" height=\"93\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:black 1px solid\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>5.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Under the <strong>Columns</strong> section, click <strong>Create Column</strong>&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266476\"><img title=\"pic9\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266525\" border=\"0\" alt=\"pic9\" width=\"680\" height=\"216\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:black 1px solid\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>6.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>In the <strong>Name and Type</strong> section of the <strong>\r\nCreate Column</strong> page, enter a name for your field and select <strong>reCAPTCHA for SharePoint</strong>&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266478\"><img title=\"pic10\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266741\" border=\"0\" alt=\"pic10\" width=\"232\" height=\"244\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>7.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>In the reCAPTCHA Column Settings section of the Create Column page, enter your Public and Private keys and optionally change the default Theme (red) or Language (English).&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266480\"><img title=\"pic11\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266528\" border=\"0\" alt=\"pic11\" width=\"244\" height=\"138\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:1px solid black\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>8.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Click OK.</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>9.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span></span>Now go to a new or existing blog post and notice that the reCAPTCHA control is visible in the Comments section of the post:&nbsp;</p>\r\n<p>&nbsp;<a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266482\"><img title=\"pic12\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266524\" border=\"0\" alt=\"pic12\" width=\"212\" height=\"269\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:black 1px solid\"></a></p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\"><span><span>10.<span style=\"font:7pt &quot;Times New Roman&quot;\">&nbsp;&nbsp;\r\n</span></span></span>If you don&rsquo;t enter the values or enter the wrong values you are prompted with an error message:</p>\r\n<p><a href=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266484\"><img title=\"pic13\" src=\"http://download.codeplex.com/download?ProjectName=recaptchaforsp&DownloadId=266515\" border=\"0\" alt=\"pic13\" width=\"218\" height=\"273\" style=\"padding-left:0px; padding-right:0px; display:inline; padding-top:0px; border:black 1px solid\"></a>&nbsp;</p>\r\n<p style=\"text-indent:-0.25in; margin:0in 0in 0pt 0.5in\">&nbsp;</p>\r\n<p style=\"margin:0in 0in 0pt\">That&rsquo;s it.<span>&nbsp; </span>My Blog comments now have an integrated reCAPTCHA capability without writing any code or customizing any pages or templates.<span>&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 0pt\"><span>&nbsp;</span></p>\r\n<p style=\"margin:0in 0in 0pt\">In reality, you would probably want to create a reCAPTCHA Site Column and just use it in whatever content types and lists you want to prompt the user to enter it.<span>&nbsp;\r\n</span>This way you don&rsquo;t have to manage the Public and Private keys in multiple locations.<span>&nbsp;\r\n</span>Just got to <strong>Site Actions</strong> &gt; <strong>Site Settings</strong> &gt;\r\n<strong>Site columns</strong> (under <strong>Galleries</strong>) and add a custom Site Column.</p>\r\n<p>&nbsp;</p>\r\n<p><strong><span style=\"font-size:16pt\">About SharePointable</span></strong></p>\r\n<p>I&rsquo;m a 25-year information technology veteran with a primary focus on software architecture and development.&nbsp; I have served in different capacities for well-known Microsoft partners K2, KnowledgeLake, and Metalogix as well as being a founder of\r\n BlueThread Technologies and now Portal Associates.</p>\r\n<p>I consider myself an expert with .NET, SharePoint, and legacy ECM platforms and have applied that experience across a wide range of solution types and vertical industries.&nbsp; I am considered a subject matter expert on ECM and BPM approaches and technologies\r\n and have deep knowledge of how ECM and BPM can be applied to financial services, retail, healthcare, and manufacturing&nbsp;organizations.</p>\r\n<p>When I&rsquo;m not tinkering with technology, I&rsquo;m a husband, father of four children (3 boys, 1 girl), animal lover (2 dogs, 2 cats, and a turtle), and fairly normal guy.</p>\r\n<p><span style=\"color:#17365d\">&nbsp;</span>Check out my blog at <a href=\"http://About SharePointable\" target=\"_blank\">\r\nblog.sharepointable.com</a></p>\r\n</div><div class=\"ClearBoth\"></div>",
  "TagList": "",
  "LastEdited": "2011-08-04T07:24:20.04-07:00"
}