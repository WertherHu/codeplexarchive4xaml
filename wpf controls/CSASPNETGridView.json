{
  "ProjectName": "CSASPNETGridView",
  "Title": "ASP.NET GridView control demo",
  "Description": "This project describes how to populate ASP.NET GridView control and how to implement Insert, Edit, Update, Delete, Paging and Sorting functions in ASP.NET GridV",
  "MovedLink": "",
  "HomeWiki": "<div class=\"wikidoc\">\r\n<h1>ASP.NET GridView control demo (CSASPNETGridView)</h1>\r\n<h2>Introduction</h2>\r\n<p>This CSASPNETGridView project describes how to populate ASP.NET GridView control and how to implement\r\n<strong>Insert</strong>, <strong>Edit</strong>, <strong>Update</strong>, <strong>\r\nDelete</strong>, <strong>Paging</strong> and <strong>Sorting</strong> functions in ASP.NET GridView control. We have received many posts in forums about this popular web control, so this sample provides a complete sample for showing how to implement these basic\r\n functions of this control. The sample demonstrates data source from both database and memory.</p>\r\n<h2>Building the Sample</h2>\r\n<p>For this sample to work, you must install the SqlServer 2008 R2 Express. This sample contains a SqlServer database file, if you do not install SqlServer, The DataInMemory.aspx page can also works fine. More information about SqlServer 2008 R2 Express and\r\n download links can be found here:</p>\r\n<ul>\r\n<li><a href=\"http://www.microsoft.com/download/en/details.aspx?id=16978\">SqlServer 2008 R2 details</a>\r\n</li><li><a href=\"http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=3743\">Download SqlServer 2008 R2 Express</a>\r\n</li></ul>\r\n<h2>Running the Sample</h2>\r\n<p>Please follow these demonstration steps below.</p>\r\n<p>Step 1:&nbsp;Open the CSASPNETGridView.sln. Expand the CSASPNETGridView web application and press Ctrl &#43; F5 to show the DataFromDatabase.aspx.</p>\r\n<p>Step 2: We will see a GirdView control on the page, you can add, edit, delete the columns of the GridView control, the data is come from App_Data/GridView.mdf file, and the GridView's status is stored in ViewState for persisting data across postbacks.</p>\r\n<p>&nbsp;<img src=\"http://code.msdn.microsoft.com/site/view/file/59768/1/image.png\" alt=\"\" width=\"537\" height=\"374\"></p>\r\n<p>Step 3: The GridView the page size is 15, you need insert 16 Persons in this GridView to see the next page. Please click the title of the GridView to sort the result by PersonID, LastName or FirstName properties.</p>\r\n<p>&nbsp;<img src=\"http://code.msdn.microsoft.com/site/view/file/59769/1/image.png\" alt=\"\" width=\"533\" height=\"575\"></p>\r\n<p>Step 4: Please press Ctrl&#43;F5 to show DataInMemory.aspx page, the test steps just like DataFromDataBase.aspx.</p>\r\n<p>Step 5: Validation finished.</p>\r\n<h2>Using the Code</h2>\r\n<p>Code Logical:</p>\r\n<p>Step 1. Create a C# &quot;ASP.NET Empty Web Application&quot; in Visual Studio 2010 or Visual Web Developer 2010. Name it as &quot;CSASPNETGridView &quot;. The project includes two web form pages for demonstrating two ways to bind data source with the GridView, name them as\r\n &quot;DataFromDataBase.aspx&quot;, &quot;DataInMemory.aspx&quot;.</p>\r\n<p>Step 2. Before we start to write code, we need install SqlServer 2008 R2 Express and create a database file as the data source of GridView control. Add an Asp.net folder &quot;App_Data&quot; and create a Sql Server Database,&quot;GridView.mdf&quot;. Add &quot;Person&quot; table with\r\n three fields &quot;PersonID&quot;,&quot;FirstName&quot;,&quot;LastName&quot;, PersonID is the primary key of the table, and you can insert some default values in Person table.</p>\r\n<p>Step 3. Drag and drop a GridView control, two LinkButton controls, two TextBox controls and a Panel control into DataFromDataBase.aspx page. The GridView is used to display, edit and delete the data of database file, the TextBox and LinkButton are used to\r\n insert new items to the data table. In the first step, check your controls and rename them and set some basic properties of the GridView, such as GridView's templates and events.</p>\r\n<h3>The following Html code is showing the GridView's necessary events (onpageindexchanging, onrowcancelingedit,<span style=\"font-size:9.5pt; color:red\">\r\n</span>onrowdatabound, etc), GridView's TemplateField and other controls:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h3>\r\n<div>\r\n<div>\r\n<div><span>&nbsp;</span></div>\r\n<pre class=\"html\"><span>&lt;asp</span>:GridView&nbsp;<span>ID</span>=<span>&quot;gvPerson&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;<span>AutoGenerateColumns</span>=<span>&quot;False&quot;</span>&nbsp;<span>BackColor</span>=<span>&quot;White&quot;</span>&nbsp;&nbsp;\r\n<span>BorderColor</span>=<span>&quot;#3366CC&quot;</span>&nbsp;<span>BorderStyle</span>=<span>&quot;None&quot;</span>&nbsp;<span>BorderWidth</span>=<span>&quot;1px&quot;</span>&nbsp;<span>CellPadding</span>=<span>&quot;4&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>onpageindexchanging</span>=<span>&quot;gvPerson_PageIndexChanging&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>onrowcancelingedit</span>=<span>&quot;gvPerson_RowCancelingEdit&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>onrowdatabound</span>=<span>&quot;gvPerson_RowDataBound&quot;</span>&nbsp;<span>onrowdeleting</span>=<span>&quot;gvPerson_RowDeleting&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>onrowediting</span>=<span>&quot;gvPerson_RowEditing&quot;</span>&nbsp;<span>onrowupdating</span>=<span>&quot;gvPerson_RowUpdating&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>onsorting</span>=<span>&quot;gvPerson_Sorting&quot;</span><span>&gt;&nbsp;\r\n</span><span>&lt;RowStyle</span>&nbsp;<span>BackColor</span>=<span>&quot;White&quot;</span>&nbsp;<span>ForeColor</span>=<span>&quot;#003399&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;Columns</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:CommandField&nbsp;<span>ShowEditButton</span>=<span>&quot;True&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:CommandField&nbsp;<span>ShowDeleteButton</span>=<span>&quot;True&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:BoundField&nbsp;<span>DataField</span>=<span>&quot;PersonID&quot;</span>&nbsp;<span>HeaderText</span>=<span>&quot;PersonID&quot;</span>&nbsp;<span>ReadOnly</span>=<span>&quot;True&quot;</span>&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>SortExpression</span>=<span>&quot;PersonID&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TemplateField&nbsp;<span>HeaderText</span>=<span>&quot;LastName&quot;</span>&nbsp;<span>SortExpression</span>=<span>&quot;LastName&quot;</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;EditItemTemplate</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TextBox&nbsp;<span>ID</span>=<span>&quot;TextBox1&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;Text='&lt;%#&nbsp;Bind(&quot;LastName&quot;)&nbsp;<span>%&gt;</span>'&gt;<span>&lt;/asp:TextBox&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/EditItemTemplate&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;ItemTemplate</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:Label&nbsp;<span>ID</span>=<span>&quot;Label1&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;Text='&lt;%#&nbsp;Bind(&quot;LastName&quot;)&nbsp;<span>%&gt;</span>'&gt;<span>&lt;/asp:Label&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/ItemTemplate&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/asp:TemplateField&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TemplateField&nbsp;<span>HeaderText</span>=<span>&quot;FirstName&quot;</span>&nbsp;<span>SortExpression</span>=<span>&quot;FirstName&quot;</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;EditItemTemplate</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TextBox&nbsp;<span>ID</span>=<span>&quot;TextBox2&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;Text='&lt;%#&nbsp;Bind(&quot;FirstName&quot;)&nbsp;<span>%&gt;</span>'&gt;<span>&lt;/asp:TextBox&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/EditItemTemplate&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;ItemTemplate</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:Label&nbsp;<span>ID</span>=<span>&quot;Label2&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;Text='&lt;%#&nbsp;Bind(&quot;FirstName&quot;)&nbsp;<span>%&gt;</span>'&gt;<span>&lt;/asp:Label&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/ItemTemplate&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/asp:TemplateField&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;/Columns&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;FooterStyle</span>&nbsp;<span>BackColor</span>=<span>&quot;#99CCCC&quot;</span>&nbsp;<span>ForeColor</span>=<span>&quot;#003399&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;PagerStyle</span>&nbsp;<span>BackColor</span>=<span>&quot;#99CCCC&quot;</span>&nbsp;<span>ForeColor</span>=<span>&quot;#003399&quot;</span>&nbsp;<span>HorizontalAlign</span>=<span>&quot;Left&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;SelectedRowStyle</span>&nbsp;<span>BackColor</span>=<span>&quot;#009999&quot;</span>&nbsp;<span>Font-Bold</span>=<span>&quot;True&quot;</span>&nbsp;<span>ForeColor</span>=<span>&quot;#CCFF99&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;HeaderStyle</span>&nbsp;<span>BackColor</span>=<span>&quot;#003399&quot;</span>&nbsp;<span>Font-Bold</span>=<span>&quot;True&quot;</span>&nbsp;<span>ForeColor</span>=<span>&quot;#CCCCFF&quot;</span>&nbsp;<span>/&gt;</span>&nbsp;\r\n<span>&lt;/asp:GridView&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;\r\n<span>&lt;asp</span>:LinkButton&nbsp;<span>ID</span>=<span>&quot;lbtnAdd&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;<span>onclick</span>=<span>&quot;lbtnAdd_Click&quot;</span><span>&gt;</span>AddNew<span>&lt;/asp:LinkButton&gt;</span>&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>&lt;asp</span>:Panel&nbsp;<span>ID</span>=<span>&quot;pnlAdd&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;<span>Visible</span>=<span>&quot;False&quot;</span><span>&gt;&nbsp;\r\n</span>&nbsp;&nbsp;&nbsp;&nbsp;Last&nbsp;name:&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TextBox&nbsp;<span>ID</span>=<span>&quot;tbLastName&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span><span>&gt;</span><span>&lt;/asp:TextBox&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;First&nbsp;name:&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:TextBox&nbsp;<span>ID</span>=<span>&quot;tbFirstName&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span><span>&gt;</span><span>&lt;/asp:TextBox&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:LinkButton&nbsp;<span>ID</span>=<span>&quot;lbtnSubmit&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;<span>onclick</span>=<span>&quot;lbtnSubmit_Click&quot;</span><span>&gt;</span>Submit<span>&lt;/asp:LinkButton&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>&lt;asp</span>:LinkButton&nbsp;<span>ID</span>=<span>&quot;lbtnCancel&quot;</span>&nbsp;<span>runat</span>=<span>&quot;server&quot;</span>&nbsp;<span>onclick</span>=<span>&quot;lbtnCancel_Click&quot;</span><span>&gt;</span>Cancel<span>&lt;/asp:LinkButton&gt;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<span>&lt;/asp:Panel&gt;</span>&nbsp;\r\n&nbsp;\r\n</pre>\r\n</div>\r\n</div>\r\n<p>Step 4. Copy the Page_Load and BindGridView methods of the sample and paste them to your DataFromDataBase.aspx.cs file, and navigator to the Property panel and switch to Event. Double click on the following event and generate the Event Handlers, after that,\r\n fill the generated methods with the sample code.</p>\r\n<ul>\r\n<li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx\">RowDataBound Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.pageindexchanging.aspx\">PageIndexChanging Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowediting.aspx\">RowEditing Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcancelingedit.aspx\">RowCancelingEdit Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowupdating.aspx\">RowUpdating Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdeleting.aspx\">RowDeleting Event</a>\r\n</li><li><a href=\"http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.sorting.aspx\">Sorting Event</a>\r\n</li></ul>\r\n<h3>The following code is used to implement the basic functions of the GridView control.</h3>\r\n<div>\r\n<div>\r\n<div><span>&nbsp;</span></div>\r\n<pre><span>protected</span>&nbsp;<span>void</span>&nbsp;Page_Load(<span>object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;The&nbsp;Page&nbsp;is&nbsp;accessed&nbsp;for&nbsp;the&nbsp;first&nbsp;time.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(!IsPostBack)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Enable&nbsp;the&nbsp;GridView&nbsp;paging&nbsp;option&nbsp;and&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;specify&nbsp;the&nbsp;page&nbsp;size.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.AllowPaging&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.PageSize&nbsp;=&nbsp;<span>15</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Enable&nbsp;the&nbsp;GridView&nbsp;sorting&nbsp;option.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.AllowSorting&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Initialize&nbsp;the&nbsp;sorting&nbsp;expression.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>]&nbsp;=&nbsp;<span>&quot;PersonID&nbsp;ASC&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Populate&nbsp;the&nbsp;GridView.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>private</span>&nbsp;<span>void</span>&nbsp;BindGridView()&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Get&nbsp;the&nbsp;connection&nbsp;string&nbsp;from&nbsp;Web.config.&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;When&nbsp;we&nbsp;use&nbsp;Using&nbsp;statement,&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;we&nbsp;don't&nbsp;need&nbsp;to&nbsp;explicitly&nbsp;dispose&nbsp;the&nbsp;object&nbsp;in&nbsp;the&nbsp;code,&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;the&nbsp;using&nbsp;statement&nbsp;takes&nbsp;care&nbsp;of&nbsp;it.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>using</span>&nbsp;(SqlConnection&nbsp;conn&nbsp;=&nbsp;<span>new</span>&nbsp;SqlConnection(ConfigurationManager.ConnectionStrings[<span>&quot;SQLServer2005DBConnectionString&quot;</span>].ToString()))&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;DataSet&nbsp;object.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataSet&nbsp;dsPerson&nbsp;=&nbsp;<span>new</span>&nbsp;DataSet();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;SELECT&nbsp;query.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>&nbsp;strSelectCmd&nbsp;=&nbsp;<span>&quot;SELECT&nbsp;PersonID,LastName,FirstName&nbsp;FROM&nbsp;Person&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;SqlDataAdapter&nbsp;object</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;SqlDataAdapter&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;data&nbsp;commands&nbsp;and&nbsp;a&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;database&nbsp;connection&nbsp;that&nbsp;are&nbsp;used&nbsp;to&nbsp;fill&nbsp;the&nbsp;DataSet&nbsp;and&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;update&nbsp;a&nbsp;SQL&nbsp;Server&nbsp;database.&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAdapter&nbsp;da&nbsp;=&nbsp;<span>new</span>&nbsp;SqlDataAdapter(strSelectCmd,&nbsp;conn);&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Open&nbsp;the&nbsp;connection</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Open();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Fill&nbsp;the&nbsp;DataTable&nbsp;named&nbsp;&quot;Person&quot;&nbsp;in&nbsp;DataSet&nbsp;with&nbsp;the&nbsp;rows</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;returned&nbsp;by&nbsp;the&nbsp;query.new&nbsp;n</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;da.Fill(dsPerson,&nbsp;<span>&quot;Person&quot;</span>);&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Get&nbsp;the&nbsp;DataView&nbsp;from&nbsp;Person&nbsp;DataTable.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataView&nbsp;dvPerson&nbsp;=&nbsp;dsPerson.Tables[<span>&quot;Person&quot;</span>].DefaultView;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;sort&nbsp;column&nbsp;and&nbsp;sort&nbsp;order.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dvPerson.Sort&nbsp;=&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>].ToString();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Bind&nbsp;the&nbsp;GridView&nbsp;control.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.DataSource&nbsp;=&nbsp;dvPerson;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.DataBind();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.RowDataBound&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_RowDataBound(<span>object</span>&nbsp;sender,&nbsp;GridViewRowEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;current&nbsp;GridViewRow&nbsp;is&nbsp;a&nbsp;data&nbsp;row.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(e.Row.RowType&nbsp;==&nbsp;DataControlRowType.DataRow)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Make&nbsp;sure&nbsp;the&nbsp;current&nbsp;GridViewRow&nbsp;is&nbsp;either&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;in&nbsp;the&nbsp;normal&nbsp;state&nbsp;or&nbsp;an&nbsp;alternate&nbsp;row.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(e.Row.RowState&nbsp;==&nbsp;DataControlRowState.Normal&nbsp;||&nbsp;e.Row.RowState&nbsp;==&nbsp;DataControlRowState.Alternate)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Add&nbsp;client-side&nbsp;confirmation&nbsp;when&nbsp;deleting.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((LinkButton)e.Row.Cells[<span>1</span>].Controls[<span>0</span>]).Attributes[<span>&quot;onclick&quot;</span>]&nbsp;=&nbsp;<span>&quot;if(!confirm('Are&nbsp;you&nbsp;certain&nbsp;you&nbsp;want&nbsp;to&nbsp;delete&nbsp;this&nbsp;person&nbsp;?'))&nbsp;return&nbsp;false;&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.PageIndexChanging&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_PageIndexChanging(<span>object</span>&nbsp;sender,&nbsp;GridViewPageEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;index&nbsp;of&nbsp;the&nbsp;new&nbsp;display&nbsp;page.&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.PageIndex&nbsp;=&nbsp;e.NewPageIndex;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;show&nbsp;data&nbsp;in&nbsp;the&nbsp;new&nbsp;page.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.RowEditing&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_RowEditing(<span>object</span>&nbsp;sender,&nbsp;GridViewEditEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Make&nbsp;the&nbsp;GridView&nbsp;control&nbsp;into&nbsp;edit&nbsp;mode&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;for&nbsp;the&nbsp;selected&nbsp;row.&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.EditIndex&nbsp;=&nbsp;e.NewEditIndex;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;data&nbsp;in&nbsp;edit&nbsp;mode.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Hide&nbsp;the&nbsp;Add&nbsp;button.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>false</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.RowCancelingEdit&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_RowCancelingEdit(<span>object</span>&nbsp;sender,&nbsp;GridViewCancelEditEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Exit&nbsp;edit&nbsp;mode.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.EditIndex&nbsp;=&nbsp;-<span>1</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;data&nbsp;in&nbsp;view&nbsp;mode.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Show&nbsp;the&nbsp;Add&nbsp;button.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.RowUpdating&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_RowUpdating(<span>object</span>&nbsp;sender,&nbsp;GridViewUpdateEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>using</span>&nbsp;(SqlConnection&nbsp;conn&nbsp;=&nbsp;<span>new</span>&nbsp;SqlConnection(ConfigurationManager.ConnectionStrings[<span>&quot;SQLServer2005DBConnectionString&quot;</span>].ToString()))&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;command&nbsp;object.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;cmd&nbsp;=&nbsp;<span>new</span>&nbsp;SqlCommand();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Assign&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Connection&nbsp;=&nbsp;conn;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;text</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;SQL&nbsp;statement&nbsp;or&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;stored&nbsp;procedure&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandText&nbsp;=&nbsp;<span>&quot;UPDATE&nbsp;Person&nbsp;SET&nbsp;LastName&nbsp;=&nbsp;@LastName,&nbsp;FirstName&nbsp;=&nbsp;@FirstName&nbsp;WHERE&nbsp;PersonID&nbsp;=&nbsp;@PersonID&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;type</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.Text&nbsp;for&nbsp;ordinary&nbsp;SQL&nbsp;statements;&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.StoredProcedure&nbsp;for&nbsp;stored&nbsp;procedures.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandType&nbsp;=&nbsp;CommandType.Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Get&nbsp;the&nbsp;PersonID&nbsp;of&nbsp;the&nbsp;selected&nbsp;row.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>&nbsp;strPersonID&nbsp;=&nbsp;gvPerson.Rows[e.RowIndex].Cells[<span>2</span>].Text;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>&nbsp;strLastName&nbsp;=&nbsp;((TextBox)gvPerson.Rows[e.RowIndex].FindControl(<span>&quot;TextBox1&quot;</span>)).Text;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>&nbsp;strFirstName&nbsp;=&nbsp;((TextBox)gvPerson.Rows[e.RowIndex].FindControl(<span>&quot;TextBox2&quot;</span>)).Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Append&nbsp;the&nbsp;parameters.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@PersonID&quot;</span>,&nbsp;SqlDbType.Int).Value&nbsp;=&nbsp;strPersonID;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@LastName&quot;</span>,&nbsp;SqlDbType.NVarChar,&nbsp;<span>50</span>).Value&nbsp;=&nbsp;strLastName;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@FirstName&quot;</span>,&nbsp;SqlDbType.NVarChar,&nbsp;<span>50</span>).Value&nbsp;=&nbsp;strFirstName;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Open&nbsp;the&nbsp;connection.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Open();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Execute&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.ExecuteNonQuery();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Exit&nbsp;edit&nbsp;mode.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.EditIndex&nbsp;=&nbsp;-<span>1</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;data&nbsp;after&nbsp;updating.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Show&nbsp;the&nbsp;Add&nbsp;button.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.RowDeleting&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_RowDeleting(<span>object</span>&nbsp;sender,&nbsp;GridViewDeleteEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>using</span>&nbsp;(SqlConnection&nbsp;conn&nbsp;=&nbsp;<span>new</span>&nbsp;SqlConnection(ConfigurationManager.ConnectionStrings[<span>&quot;SQLServer2005DBConnectionString&quot;</span>].ToString()))&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;command&nbsp;object.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;cmd&nbsp;=&nbsp;<span>new</span>&nbsp;SqlCommand();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Assign&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Connection&nbsp;=&nbsp;conn;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;text</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;SQL&nbsp;statement&nbsp;or&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;stored&nbsp;procedure&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandText&nbsp;=&nbsp;<span>&quot;DELETE&nbsp;FROM&nbsp;Person&nbsp;WHERE&nbsp;PersonID&nbsp;=&nbsp;@PersonID&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;type</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.Text&nbsp;for&nbsp;ordinary&nbsp;SQL&nbsp;statements;&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.StoredProcedure&nbsp;for&nbsp;stored&nbsp;procedures.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandType&nbsp;=&nbsp;CommandType.Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Get&nbsp;the&nbsp;PersonID&nbsp;of&nbsp;the&nbsp;selected&nbsp;row.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>&nbsp;strPersonID&nbsp;=&nbsp;gvPerson.Rows[e.RowIndex].Cells[<span>2</span>].Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Append&nbsp;the&nbsp;parameter.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@PersonID&quot;</span>,&nbsp;SqlDbType.Int).Value&nbsp;=&nbsp;strPersonID;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Open&nbsp;the&nbsp;connection.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Open();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Execute&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.ExecuteNonQuery();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;data&nbsp;after&nbsp;deleting.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>//&nbsp;GridView.Sorting&nbsp;Event</span>&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;gvPerson_Sorting(<span>object</span>&nbsp;sender,&nbsp;GridViewSortEventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>string</span>[]&nbsp;strSortExpression&nbsp;=&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>].ToString().Split(<span>'&nbsp;'</span>);&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;If&nbsp;the&nbsp;sorting&nbsp;column&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;previous&nbsp;one,&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;then&nbsp;change&nbsp;the&nbsp;sort&nbsp;order.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(strSortExpression[<span>0</span>]&nbsp;==&nbsp;e.SortExpression)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(strSortExpression[<span>1</span>]&nbsp;==&nbsp;<span>&quot;ASC&quot;</span>)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>]&nbsp;=&nbsp;e.SortExpression&nbsp;&#43;&nbsp;<span>&quot;&nbsp;&quot;</span>&nbsp;&#43;&nbsp;<span>&quot;DESC&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>else</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>]&nbsp;=&nbsp;e.SortExpression&nbsp;&#43;&nbsp;<span>&quot;&nbsp;&quot;</span>&nbsp;&#43;&nbsp;<span>&quot;ASC&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;If&nbsp;sorting&nbsp;column&nbsp;is&nbsp;another&nbsp;column,&nbsp;&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;then&nbsp;specify&nbsp;the&nbsp;sort&nbsp;order&nbsp;to&nbsp;&quot;Ascending&quot;.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>else</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>]&nbsp;=&nbsp;e.SortExpression&nbsp;&#43;&nbsp;<span>&quot;&nbsp;&quot;</span>&nbsp;&#43;&nbsp;<span>&quot;ASC&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;sorted&nbsp;data.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n</pre>\r\n</div>\r\n</div>\r\n<p>Step 5. Double click on the Click event of LinkButton control to generate the event handler and fill the generated methods with the sample, these two button are used to add new items to the database file and cancel the insert operate.</p>\r\n<h3>The following code shows how to insert new items to the database file.</h3>\r\n<div>\r\n<div>\r\n<div><span>&nbsp;</span></div>\r\n<pre><span>protected</span>&nbsp;<span>void</span>&nbsp;lbtnAdd_Click(<span>object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Hide&nbsp;the&nbsp;Add&nbsp;button&nbsp;and&nbsp;showing&nbsp;Add&nbsp;panel.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>false</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;pnlAdd.Visible&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;lbtnSubmit_Click(<span>object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>using</span>&nbsp;(SqlConnection&nbsp;conn&nbsp;=&nbsp;<span>new</span>&nbsp;SqlConnection(ConfigurationManager.ConnectionStrings[<span>&quot;SQLServer2005DBConnectionString&quot;</span>].ToString()))&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;command&nbsp;object.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;cmd&nbsp;=&nbsp;<span>new</span>&nbsp;SqlCommand();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Assign&nbsp;the&nbsp;connection&nbsp;to&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Connection&nbsp;=&nbsp;conn;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;text</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;SQL&nbsp;statement&nbsp;or&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;stored&nbsp;procedure&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandText&nbsp;=&nbsp;<span>&quot;INSERT&nbsp;INTO&nbsp;Person&nbsp;(&nbsp;LastName,&nbsp;FirstName&nbsp;)&nbsp;VALUES&nbsp;(&nbsp;@LastName,&nbsp;@FirstName&nbsp;)&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;command&nbsp;type</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.Text&nbsp;for&nbsp;ordinary&nbsp;SQL&nbsp;statements;&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;CommandType.StoredProcedure&nbsp;for&nbsp;stored&nbsp;procedures.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.CommandType&nbsp;=&nbsp;CommandType.Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Append&nbsp;the&nbsp;parameters.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@LastName&quot;</span>,&nbsp;SqlDbType.NVarChar,&nbsp;<span>50</span>).Value&nbsp;=&nbsp;tbLastName.Text;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.Parameters.Add(<span>&quot;@FirstName&quot;</span>,&nbsp;SqlDbType.NVarChar,&nbsp;<span>50</span>).Value&nbsp;=&nbsp;tbFirstName.Text;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Open&nbsp;the&nbsp;connection.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Open();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Execute&nbsp;the&nbsp;command.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd.ExecuteNonQuery();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Rebind&nbsp;the&nbsp;GridView&nbsp;control&nbsp;to&nbsp;show&nbsp;inserted&nbsp;data.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;BindGridView();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Empty&nbsp;the&nbsp;TextBox&nbsp;controls.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;tbLastName.Text&nbsp;=&nbsp;<span>&quot;&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;tbFirstName.Text&nbsp;=&nbsp;<span>&quot;&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Show&nbsp;the&nbsp;Add&nbsp;button&nbsp;and&nbsp;hiding&nbsp;the&nbsp;Add&nbsp;panel.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;pnlAdd.Visible&nbsp;=&nbsp;<span>false</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>protected</span>&nbsp;<span>void</span>&nbsp;lbtnCancel_Click(<span>object</span>&nbsp;sender,&nbsp;EventArgs&nbsp;e)&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Empty&nbsp;the&nbsp;TextBox&nbsp;controls.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;tbLastName.Text&nbsp;=&nbsp;<span>&quot;&quot;</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;tbFirstName.Text&nbsp;=&nbsp;<span>&quot;&quot;</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Show&nbsp;the&nbsp;Add&nbsp;button&nbsp;and&nbsp;hiding&nbsp;the&nbsp;Add&nbsp;panel.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;lbtnAdd.Visible&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;pnlAdd.Visible&nbsp;=&nbsp;<span>false</span>;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n</pre>\r\n</div>\r\n</div>\r\n<p>Step 6. The DataInMemory.aspx page is pretty much the same with DataFromDataBase.aspx page, this web page get data from memory, instead of database file. So we only need to add a new method &quot;InitializeDataSource&quot; for generating the DataTable variable, then\r\n we need to modify the BindGridView method to bind new the DataTable with GridView.</p>\r\n<h3>The following code is use initialize the DataTable and stores it in ViewState.</h3>\r\n<div>\r\n<div>\r\n<div><span>&nbsp;</span></div>\r\n<pre><span>//&nbsp;Initialize&nbsp;the&nbsp;DataTable.</span>&nbsp;\r\n<span>private</span>&nbsp;<span>void</span>&nbsp;InitializeDataSource()&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Create&nbsp;a&nbsp;DataTable&nbsp;object&nbsp;named&nbsp;dtPerson.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;DataTable&nbsp;dtPerson&nbsp;=&nbsp;<span>new</span>&nbsp;DataTable();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Add&nbsp;four&nbsp;columns&nbsp;to&nbsp;the&nbsp;DataTable.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns.Add(<span>&quot;PersonID&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns.Add(<span>&quot;LastName&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns.Add(<span>&quot;FirstName&quot;</span>);&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Specify&nbsp;PersonID&nbsp;column&nbsp;as&nbsp;an&nbsp;auto&nbsp;increment&nbsp;column</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;and&nbsp;set&nbsp;the&nbsp;starting&nbsp;value&nbsp;and&nbsp;increment.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns[<span>&quot;PersonID&quot;</span>].AutoIncrement&nbsp;=&nbsp;<span>true</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns[<span>&quot;PersonID&quot;</span>].AutoIncrementSeed&nbsp;=&nbsp;<span>1</span>;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Columns[<span>&quot;PersonID&quot;</span>].AutoIncrementStep&nbsp;=&nbsp;<span>1</span>;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;PersonID&nbsp;column&nbsp;as&nbsp;the&nbsp;primary&nbsp;key.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;DataColumn[]&nbsp;dcKeys&nbsp;=&nbsp;<span>new</span>&nbsp;DataColumn[<span>1</span>];&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dcKeys[<span>0</span>]&nbsp;=&nbsp;dtPerson.Columns[<span>&quot;PersonID&quot;</span>];&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.PrimaryKey&nbsp;=&nbsp;dcKeys;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Add&nbsp;new&nbsp;rows&nbsp;into&nbsp;the&nbsp;DataTable.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Davolio&quot;</span>,&nbsp;<span>&quot;Nancy&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Fuller&quot;</span>,&nbsp;<span>&quot;Andrew&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Leverling&quot;</span>,&nbsp;<span>&quot;Janet&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Dodsworth&quot;</span>,&nbsp;<span>&quot;Anne&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Buchanan&quot;</span>,&nbsp;<span>&quot;Steven&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Suyama&quot;</span>,&nbsp;<span>&quot;Michael&quot;</span>);&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;dtPerson.Rows.Add(<span>null</span>,&nbsp;<span>&quot;Callahan&quot;</span>,&nbsp;<span>&quot;Laura&quot;</span>);&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Store&nbsp;the&nbsp;DataTable&nbsp;in&nbsp;ViewState.&nbsp;</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;ViewState[<span>&quot;dtPerson&quot;</span>]&nbsp;=&nbsp;dtPerson;&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n<span>private</span>&nbsp;<span>void</span>&nbsp;BindGridView()&nbsp;\r\n{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;<span>if</span>&nbsp;(ViewState[<span>&quot;dtPerson&quot;</span>]&nbsp;!=&nbsp;<span>null</span>)&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Get&nbsp;the&nbsp;DataTable&nbsp;from&nbsp;ViewState.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataTable&nbsp;dtPerson&nbsp;=&nbsp;(DataTable)ViewState[<span>&quot;dtPerson&quot;</span>];&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Convert&nbsp;the&nbsp;DataTable&nbsp;to&nbsp;DataView.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataView&nbsp;dvPerson&nbsp;=&nbsp;<span>new</span>&nbsp;DataView(dtPerson);&nbsp;&nbsp;&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Set&nbsp;the&nbsp;sort&nbsp;column&nbsp;and&nbsp;sort&nbsp;order.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dvPerson.Sort&nbsp;=&nbsp;ViewState[<span>&quot;SortExpression&quot;</span>].ToString();&nbsp;\r\n&nbsp;\r\n&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Bind&nbsp;the&nbsp;GridView&nbsp;control.</span>&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.DataSource&nbsp;=&nbsp;dvPerson;&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gvPerson.DataBind();&nbsp;\r\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;\r\n}&nbsp;\r\n&nbsp;\r\n</pre>\r\n</div>\r\n</div>\r\n<p>Step 7. Build the application and you can debug it.</p>\r\n<p>&nbsp;</p>\r\n<h2>More Information</h2>\r\n<ul>\r\n<li><a href=\"http://msdn.microsoft.com/en-us/library/yh598w02%28v=VS.80%29.aspx\">using Statement (C# Reference)</a>\r\n</li><li><span style=\"font-size:9.5pt\">&nbsp;</span> </li><li><span style=\"font-size:9.5pt\"><a href=\"http://www.asp.net/data-access/tutorials/editing,-inserting,-and-deleting-data\">Editing, Inserting, and Deleting Data</a>\r\n</span></li><li><span style=\"font-size:9.5pt\"><a href=\"http://www.asp.net/data-access/tutorials/adding-client-side-confirmation-when-deleting-vb\">Adding Client-Side Confirmation When Deleting</a>\r\n</span></li></ul>\r\n<hr>\r\n</div><div class=\"ClearBoth\"></div>",
  "TagList": "AspGridView,",
  "LastEdited": "2013-02-13T00:29:42.103-08:00"
}